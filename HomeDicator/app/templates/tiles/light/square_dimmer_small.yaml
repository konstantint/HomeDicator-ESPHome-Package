# Toggle button with a dimmer ark.
obj:
  id: tile_${esphome_id}
  styles: info_or_button_tile_small
  bg_color: 0x444444
  clickable: true
  layout:
    type: FLEX
    flex_flow: COLUMN
    flex_align_main: CENTER
    flex_align_cross: CENTER
    flex_align_track: CENTER
    pad_row: 0
  
  # Toggle light when tile background is clicked
  on_click:
    then:
      - homeassistant.action:
          action: light.toggle
          data:
            entity_id: ${hass_id}

  widgets:
    - arc:
        id: arc_${esphome_id}
        width: 70
        height: 70
        min_value: 0
        max_value: 100
        value: 0
        adjustable: true
        arc_width: 15
        arc_color: 0x222222
        indicator:
          arc_width: 15
          arc_color: 0xFFFFFF
        knob:
          bg_color: 0xFFFFFF
          pad_all: 3
        
        on_press:
          then:
            - globals.set:
                id: user_is_interacting
                value: 'true'
        
        on_release:
          then:
            - globals.set:
                id: user_is_interacting
                value: 'false'
            - homeassistant.action:
                action: light.turn_on
                data:
                  entity_id: ${hass_id}
                  brightness_pct: !lambda "return to_string(lv_arc_get_value(id(arc_${esphome_id})));"
                
    - label:
        id: title_${esphome_id}
        styles: info_or_button_tile_subtitle
        text_color: 0xffffff
        text: ${title}
        pad_top: 0
        text_font: libreFranklin10
        clickable: false # Pass click through to parent