api:
  on_client_connected:
    - if:
        condition:
          - lambda: |-
              return client_info.find("Home Assistant") != std::string::npos;
        then:
          - delay: 2s # So all sensors can load their values
          - lvgl.widget.hide: connecting_view
  on_client_disconnected:
    - if:
        condition:
          - lambda: |-
              return client_info.find("Home Assistant") != std::string::npos;
        then:
          - lvgl.widget.show: connecting_view

lvgl:
  top_layer:
    widgets:
      - obj:
          id: connecting_view
          width: SIZE_CONTENT
          height: SIZE_CONTENT
          bg_color: 0x1b1b1b
          pad_all: 0
          widgets:
          - obj:
                styles: ["full_width", "full_height"]
                pad_all: 0
                bg_opa: TRANSP
                layout:
                      type: FLEX
                      flex_flow: ROW
                      flex_align_main: CENTER
                      flex_align_cross: CENTER
                      flex_align_track: CENTER
                      pad_row: 0
                widgets:
                      - spinner:
                            width: 100
                            arc_width: 15
                            indicator:
                                  arc_width: 15
                                  arc_color: 0x92ae67
                            arc_length: 40
                            spin_time: 2s
                            arc_color: 0x474747
          - obj:
                styles: ["full_width", "full_height"]
                pad_all: 0
                bg_opa: TRANSP
                layout:
                      type: FLEX
                      flex_flow: COLUMN
                      flex_align_main: END
                      flex_align_cross: CENTER
                      flex_align_track: CENTER
                      pad_row: 0
                widgets:
                      - label:
                            pad_bottom: 20
                            text_font: libreFranklin18
                            text_color: 0xa6a6a6
                            text: !lambda return id(translate).translate("waiting_for_home_assistant");
